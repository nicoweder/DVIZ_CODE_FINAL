---
title: "Global Electricity and CO₂ Data Story"
author: "Nico Weder"
format: html
jupyter: python3
---

## Introduction
Global energy production is constantly evolving. Since humans first harnessed electricity, there has been a drive to produce ever more of it, because the availability of electricity is closely linked to the prosperity of both nations and humanity as a whole. How electricity is generated also provides insight into a country’s level of development, as it reflects the use of modern, efficient, and sustainable technologies. For decades, global energy production has grown rapidly, driven largely by fossil fuels to meet rising demand. 

However, since the 1990s, it has become increasingly clear that this approach is unsustainable. Energy production, particularly from fossil fuels, is a major driver of climate change. Because burning fossil fuels releases large amounts of carbon dioxide and other greenhouse gases into the atmosphere, trapping heat in our atmosphere. Research has shown that the future of energy lies in renewable sources, which are the only way to ensure long-term, sustainable electricity generation.

In this report, I aim to show the development of electricity production, demonstrate the economic benefits of renewable energy production and to explore the progress of the global energy transition (are we able to meet climate change targets) by combining and analysing data of three datasets.

- First data from a dataset which provides time‑series data on annual electricity generation by source for countries around the world (https://www.kaggle.com/datasets/valchovalev/electricityprodsourcestacked). 
- Then a dataset which containes the levelized cost of electricity (lcoe) for diffrent sources (https://datacatalog.worldbank.org/search/dataset/0038036/global-data-on-levelized-cost-of-electricity-generation-lcoe).
- Finally, a dataset which includes data on CO₂ emissions of persons or countries in a given time (https://github.com/owid/co2-data?tab=readme-ov-file). 

## Development of electricity production
This chart shows the historical development of global electricity production. Electricity generated from fossil fuels is shown in shades of grey, while renewable sources such as hydro, wind, solar, and bioenergy are highlighted with distinct colors and hatching. Nuclear energy is shown separately in puple because, although it is low-carbon like renewables, it is not classified as a renewable source due to its reliance on finite uranium resources. This chart is presented to illustrate the changing energy mix over time and highlight the rapid growth of renewables in contrast to the persistent dominance of fossil fuels.

```{python}
#| echo: false
#| warning: false
#| message: false


# Load Libraries
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib as mpl
from matplotlib.ticker import MultipleLocator
from matplotlib.ticker import FixedLocator

# Set plotting style
sns.set_style("whitegrid")
plt.rcParams.update({'font.size': 12})

# Load Data
energy_data = pd.read_csv("../data/electricity-prod-source-stacked.csv")
co2_data = pd.read_csv("../data/owid-co2-data.csv")
xls_lcoe = pd.ExcelFile("../data/lcoe-database.xlsx")

# Stacked Area Chart
energy_global = energy_data[energy_data['Entity'] == 'World']

energy_columns = [
    "Electricity from coal - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from gas - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from oil - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from nuclear - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from hydro - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from wind - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from solar - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from bioenergy - TWh (adapted for visualization of chart electricity-prod-source-stacked)"
]

colors = [
    "#4d4d4d", "#7f7f7f", "#bdbdbd", "#7b1fa2",
    "#009e73", "#0072b2", "#e69f00", "#56b4e9"
]

fig, ax = plt.subplots(figsize=(10,6))

# White background and full grid
ax.set_facecolor('white')
ax.grid(True, color='lightgray', linestyle='-', linewidth=0.8, alpha=0.7, zorder=0)

# Stackplot auf der Achse ax
collections = ax.stackplot(
    energy_global['Year'],
    [energy_global[col] for col in energy_columns],
    labels=[col.split(' - ')[0].replace("Electricity from ", "") for col in energy_columns],
    colors=colors
)

# Add hatching to renewables
renewable_indices = [4, 5, 6, 7]
for i in renewable_indices:
    collections[i].set_hatch('//')
    collections[i].set_edgecolor('black')
    collections[i].set_linewidth(0.6)

ax.legend(loc='upper left', frameon=False)
ax.set_title("Global Electricity Production: Fossil Dominance Despite Rapidly Growing Renewables")
ax.set_xlabel("Year")
ax.set_ylabel("Production [TWh]")

plt.tight_layout()
plt.show()
```

### Key insights
- Most energy sources are growing, including non-renewable ones. This is because electricity is needed for almost everything in today's world, and new technologies are constantly being developed, creating ever-increasing demand, for example, the internet.

- Only nuclear and gas energy production remains constant, which in the case of nuclear power is due to safety concerns. For gas, it's likely because it primarily serves to balance increased demand in the short term and is not a primary energy source.

- All renewable energy sources have seen a strong increase over the past 20 years. This is due to the recognition of the urgent need to develop renewables in the fight against climate change.

## Electricity Production: Renewable vs Fossil Fuels

The following diagram shows the development of renewable energies in green compared to non-renewable energies, which are shown in grey. Three points in time are highlighted because they either marked a decisive turning point or anomalies. This diagram is presented to emphasize the accelerating growth of renewable energy and to pinpoint events that influenced global energy production and are clearly visible at a glance.

```{python}
#| echo: false
#| warning: false
#| message: false

# Renewables vs Fossil Fuels
renewables_cols = [
    "Other renewables excluding bioenergy - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from bioenergy - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from solar - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from wind - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from hydro - TWh (adapted for visualization of chart electricity-prod-source-stacked)"
]

fossil_cols = [
    "Electricity from oil - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from gas - TWh (adapted for visualization of chart electricity-prod-source-stacked)",
    "Electricity from coal - TWh (adapted for visualization of chart electricity-prod-source-stacked)"
]

energy_global['Renewables'] = energy_global[renewables_cols].sum(axis=1)
energy_global['Fossil Fuels'] = energy_global[fossil_cols].sum(axis=1)

# Create figure and axes explicitly
fig, ax = plt.subplots(figsize=(10,6))

# Set white background and full grid behind all elements
ax.set_facecolor('white')
ax.grid(True, color='lightgray', linestyle='-', linewidth=0.8, alpha=0.7, zorder=0)

# Plot lines with zorder above grid
ax.plot(energy_global['Year'], energy_global['Renewables'], label='Renewables', color='#2ca02c', linewidth=2, zorder=2)
ax.plot(energy_global['Year'], energy_global['Fossil Fuels'], label='Fossil Fuels', color='dimgray', linewidth=2, zorder=2)

# Fill area under renewables with zorder between grid and lines
ax.fill_between(energy_global['Year'], 0, energy_global['Renewables'], color='#2ca02c', alpha=0.2, zorder=1)

# Annotate start of renewable growth
year_annot_ren = 2000
renewables_value = energy_global.loc[energy_global['Year'] == year_annot_ren, 'Renewables'].values[0]
ax.scatter(year_annot_ren, renewables_value, color='#2ca02c', s=100, edgecolor='black', linewidth=1.2, zorder=3)
ax.annotate(
    "Start of exponential growth", 
    xy=(year_annot_ren, renewables_value),
    xytext=(year_annot_ren, renewables_value + 700),
    ha='center', 
    arrowprops=dict(facecolor='black', arrowstyle="->"),
    fontsize=11, color='#2ca02c'
)

# Annotate fossil fuel events
annotations_fossil = {2008: "Financial Crisis 2008", 2020: "COVID 2020"}
for year, label in annotations_fossil.items():
    value = energy_global.loc[energy_global['Year'] == year, 'Fossil Fuels'].values[0]
    ax.scatter(year, value, color='dimgray', s=80, edgecolor='black', linewidth=1, zorder=3)
    offset = 1500 if year == 2008 else -900
    ax.annotate(
        label, 
        xy=(year, value), 
        xytext=(year, value + offset),
        ha='center', 
        arrowprops=dict(facecolor='black', arrowstyle="->"),
        fontsize=11, color='dimgray'
)

# Labels, legend, title
ax.set_title("Global Electricity Production: Renewables vs Fossil Fuels")
ax.set_xlabel("Year")
ax.set_ylabel("Production [TWh]")
ax.legend()
plt.tight_layout()
plt.show()
```
### Key insights
- The 2008 Financial Crisis is visible in the graph as a noticeable slowdown in global electricity production, particularly from fossil fuels. This reflects how economic disruptions reduce industrial activity and overall energy demand.
- The COVID situation around 2020 shows exactly the same impact on energy production as the financial crisis from 2008. Interestingly, there is hardly any change in renewable energies at these times. This could be attributed to the increased demand for green electricity.
- Renewable energies have increased sharply since the year 2000, due to the international effort to combat climate change. It is clearly evident, by looking at this illustration, that the increase in renewable energies follows an exponential growth pattern.

## Share of Renewable in Global Electricity Production
This Visualisation shows the share of renewable energy in global electricity production over time. It aims to illustrate even more clearly how renewable energies are gaining significant relevance in global electricity production. By visualizing the ratio of renewable to non-renewable energies, it becomes even more apparent which path we are on.

```{python}
#| echo: false
#| warning: false
#| message: false

# Share of Renewables
energy_global['Total_TWh'] = energy_global['Renewables'] + energy_global['Fossil Fuels']
energy_global['Renewable_Share'] = energy_global['Renewables'] / energy_global['Total_TWh'] * 100

# Create figure and axes
fig, ax = plt.subplots(figsize=(10,6))

# White background and full grid
ax.set_facecolor('white')
ax.grid(True, color='lightgray', linestyle='-', linewidth=0.8, alpha=0.7, zorder=0)

# Plot line with proper zorder
ax.plot(energy_global['Year'], energy_global['Renewable_Share'], color='#2ca02c', linewidth=2.5, zorder=2)

# Annotate start of energy transition
year_annot = 2007
value = energy_global.loc[energy_global['Year'] == year_annot, 'Renewable_Share'].values[0]
ax.scatter(year_annot, value, color='#2ca02c', s=100, edgecolor='black', linewidth=1.2, zorder=3)
ax.annotate(
    "Start of the Energy Transition", 
    xy=(year_annot, value), 
    xytext=(year_annot-2, value+2),
    ha='center', 
    arrowprops=dict(facecolor='black', arrowstyle="->"),
    fontsize=12, color='#2ca02c'
)

# Labels and title
ax.set_title("Share of Renewables in Global Electricity Production")
ax.set_xlabel("Year")
ax.set_ylabel("Renewables Share (%)")

plt.tight_layout()
plt.show()
```
### Key insights
- In the previous diagram, we saw that renewables began to grow strongly from 2000 onwards. Combining this with the current diagram, we can observe that the ratio initially changed very little. However, a few years later, the share of renewables also increased sharply. This indicates that not only did renewable energy expand, but the growth of non-renewable sources began to slow around 2007.
- Although renewable energy grows exponentially, its share compared to non-renewables rises only linearly or slightly exponential because fossil fuel production is still increasing (just a little bit slower).
- The share of renewable energies increases by between 0.7% and 1.5% per year. If this trend continues, we will obtain 50% of our energy from renewable sources in 10 to 15 years, and in approximately 60 years we would obtain 100% of our energy from renewable sources. Despite the decline in growth of non-renewable energies, is this pace far too slow to meet our climate change targets.

## Levelized Cost of Electricity for each Technology
While the previous charts focused on how electricity production has evolved over time, this diagram shifts the focus to the economic perspective by comparing the levelized cost of electricity (LCOE) across different power generation technologies. The LCOE represents the average cost of generating one unit of electricity over the entire lifetime of a power plant, including investment, operation, and maintenance costs.This comparison provides insight into how competitive renewable energy sources are relative to conventional fossil and nuclear technologies, helping to explain why certain energy sources are expanding more rapidly than others. The Boxplots in green show the lcoe of a renewable source and the boxplots in grey show the lcoe of fossile energy sources.

```{python}
#| echo: false
#| warning: false
#| message: false


# LCOE Distribution per Technology
tabs = [tab for tab in xls_lcoe.sheet_names if tab.lower() != "introduction"]

lcoe_values = {}
for tab in tabs:
    tech_code = tab.split('-')[0]
    df = pd.read_excel(xls_lcoe, sheet_name=tab, skiprows=4)
    values = df.iloc[:, -1].dropna().values
    if tech_code in lcoe_values:
        lcoe_values[tech_code] += list(values)
    else:
        lcoe_values[tech_code] = list(values)

gas_values = []
for code in ['GT','CC']:
    if code in lcoe_values:
        gas_values += lcoe_values.pop(code)
lcoe_values['GAS'] = gas_values

tech_labels = {'PV':'Solar PV','CSP':'Solar CSP','WON':'Onshore Wind','WOF':'Offshore Wind',
    'HYD':'Hydropower','BIO':'Bioenergy','GEO':'Geothermal',
    'COL':'Coal','GAS':'Gas','OIL':'Oil','NUC':'Nuclear'}

data_lcoe = []
for tech_code, values in lcoe_values.items():
    label = tech_labels.get(tech_code, tech_code)
    for v in values:
        data_lcoe.append({'Technology': label, 'LCOE': v})
df_lcoe = pd.DataFrame(data_lcoe)

medians = df_lcoe.groupby('Technology')['LCOE'].median().sort_values(ascending=False)
sorted_techs = medians.index.tolist()
renewables = ['Solar PV','Solar CSP','Onshore Wind','Offshore Wind','Hydropower','Bioenergy','Geothermal']
palette = ['green' if tech in renewables else 'gray' for tech in sorted_techs]

fig, ax = plt.subplots(figsize=(10,6))
ax.set_facecolor('white')
ax.grid(True, axis='x', color='lightgray', linestyle='-', linewidth=0.8, alpha=0.7, zorder=0)

sns.boxplot(x='LCOE', y='Technology', data=df_lcoe, order=sorted_techs,
            palette=palette, showfliers=False, ax=ax)

ax.set_xlabel("Levelized Cost of Electricity (LCOE) [$ / MWh]", fontsize=12)
ax.set_ylabel("Technology", fontsize=12)
ax.set_title("LCOE Distribution per Technology (all discount rates combined)", fontsize=14)

plt.tight_layout()
plt.show()
```
### Key insights
- Renewable energy sources such as solar PV, onshore wind, and hydropower are among the most cost-effective electricity generation technologies today. Decades of technological development and scaling have allowed them to compete directly with non-renewable alternatives.
- Newer renewable technologies, such as solar CSP, are not yet mature enough to compete on price. However, with continued innovation and investment, they may also become cost-competitive in the future. Importantly, solar and hydropower were not always cheaper than fossil fuels either. Giving emerging technologies time and support to develop is therefore crucial, as this is the only way to ensure a sufficient renewable energy supply in a future where electricity demand is expected to grow significantly.
- Although some renewable technologies are already cheaper than traditional energy sources, they have not yet fully replaced them because of existing infrastructure lock-in, the need for reliable base-load power, and the continued reliance on fossil fuels to balance supply and demand. However, in the long term, economic incentives alone should lead to fossil fuel energy production becoming obsolete.

## Co₂ per Capita vs Renewable Share
While the previous diagram focused on the cost competitiveness of different energy technologies, this final chart brings the discussion back to environmental outcomes by linking electricity production to emissions. It illustrates how the share of renewable energy in a country’s electricity mix relates to its CO₂ emissions per capita, highlighting the role renewables play in reducing climate impacts.
```{python}
#| echo: false
#| warning: false
#| message: false

# Scatter Plot CO2 per Capita vs Renewable Share
all_energy_cols = energy_data.columns[3:]
energy_data['Total_TWh'] = energy_data[all_energy_cols].sum(axis=1)
energy_data['Renewable_Share'] = energy_data[renewables_cols].sum(axis=1) / energy_data['Total_TWh'] * 100

latest_year = energy_data.groupby('Entity')['Year'].transform('max')
latest_energy = energy_data[energy_data['Year'] == latest_year].copy()
latest_year_co2 = co2_data.groupby('country')['year'].transform('max')
latest_co2 = co2_data[co2_data['year'] == latest_year_co2][['country', 'co2_per_capita']]
merged = pd.merge(latest_energy, latest_co2, left_on='Entity', right_on='country', how='inner')

fig, ax = plt.subplots(figsize=(10,6))

# White background and full grid
ax.set_facecolor('white')

# Set x-ticks exakt auf 0,20,40,...,100
ax.xaxis.set_major_locator(FixedLocator([0,20,40,60,80,100]))
ax.yaxis.set_major_locator(MultipleLocator(10))  

# Gridlines
ax.grid(which='major', color='lightgray', linestyle='-', linewidth=0.8, alpha=0.7, zorder=0)

# Scatter plot with Seaborn
sns.scatterplot(
    data=merged,
    x='Renewable_Share',
    y='co2_per_capita',
    size='Total_TWh',
    hue='Renewable_Share',
    palette='plasma',
    alpha=0.7,
    sizes=(50, 500),
    edgecolor='k',
    linewidth=0.5,
    ax=ax,
    legend=False
)

# Axes limits and labels
x_min, x_max = merged['Renewable_Share'].min(), merged['Renewable_Share'].max()
y_min, y_max = merged['co2_per_capita'].min(), merged['co2_per_capita'].max()
ax.set_xlim(x_min - 2, x_max + 2)
ax.set_ylim(y_min - 2, y_max + 2)
ax.set_xlabel("Share of Renewable Electricity (%)", fontsize=12)
ax.set_ylabel("CO2 per Capita (t)", fontsize=12)
ax.set_title("CO2 per Capita vs Renewable Share", fontsize=14, weight='bold')

# Colorbar for hue
norm = mpl.colors.Normalize(vmin=x_min, vmax=x_max)
sm = mpl.cm.ScalarMappable(cmap='plasma', norm=norm)
sm.set_array([])
cbar = plt.colorbar(sm, ax=ax, orientation='vertical', pad=0.02)
cbar.set_label('Renewable Share (%)', fontsize=12)

# Legend for sizes
size_legend = [50, 100, 200, 400]
handles = [plt.scatter([], [], s=s, color='gray', alpha=0.7, edgecolors='k', linewidth=1) for s in size_legend]
ax.legend(handles, [str(s) for s in size_legend], title='Total Electricity (TWh)',
          frameon=True, labelspacing=1.5, loc='upper right')

# Highlight specific countries
highlight_countries = ['Switzerland', 'Germany', 'United States','China', 'Brazil','Qatar', 'Norway', 'World', 'Bhutan']
label_offsets = {'China': (1.2, 0.6),'United States': (-2.0, 0.9),'World': (2.5, -0.5),
                 'France': (-1.5, -1.2),'Switzerland': (-5.5, 1.0),'Bhutan': (-3.5, 0.8),
                 'Norway': (-1.5, 0.9)}

min_size, max_size = 50, 500
twh_min, twh_max = merged['Total_TWh'].min(), merged['Total_TWh'].max()
def scale_size(twh): 
    return min_size + (twh - twh_min) / (twh_max - twh_min) * (max_size - min_size)

for _, row in merged.iterrows():
    if row['Entity'] in highlight_countries:
        ax.scatter(
            row['Renewable_Share'], row['co2_per_capita'],
            s=scale_size(row['Total_TWh']),
            facecolors='none',
            edgecolors='black',
            linewidth=2.5,
            zorder=3
        )
        dx, dy = label_offsets.get(row['Entity'], (0.6, 0.3))
        ax.text(row['Renewable_Share'] + dx, row['co2_per_capita'] + dy, row['Entity'],
                fontsize=9, weight='bold')

plt.tight_layout()
plt.show()
```
### Key insights
- Countries with a higher share of renewable energy tend to have lower CO₂ emissions per capita. This is mainly because fossil fuel–based electricity generation releases large amounts of greenhouse gases, including CO₂, whereas renewables produce little to none during operation.
- More economically and technologically advanced countries are generally more likely to have a higher share of renewable energy, as they have greater financial and institutional capacity to invest in clean technologies. However, this relationship is not universal, as countries like Brazil achieve high renewable shares largely due to favorable natural conditions rather than overall economic development.
- The total amount of electricity a country consumes does not appear to be directly linked to either CO₂ emissions per capita or the share of renewables, because emissions depend more on how electricity is generated than on how much is used, and high demand can be met with both clean and carbon-intensive energy sources.
- Some countries combine a high share of renewable electricity with relatively high CO₂ emissions per capita; Norway, for example, produces most of its electricity from hydropower but still has a sizeable carbon footprint due to high overall energy consumption, oil and gas extraction(not consumption), and transport emissions.
- Countries with very low shares of renewable energy can exhibit extremely high CO₂ emissions per capita; Qatar, for instance, relies almost entirely on fossil fuels and has energy-intensive industries and high cooling demand, which together drive its exceptionally high per-capita emissions.

## Conclusion
This data story shows that the global energy system is clearly in transition, but that the pace of change is still far from sufficient. Electricity production continues to grow steadily as societies become more digital, connected, and energy-dependent. While renewable energy sources such as wind, solar, and hydropower have expanded rapidly over the past two decades, fossil fuels remain the dominant source of global electricity.

From an economic perspective, the results are encouraging. Many renewable technologies are already among the cheapest ways to generate electricity, which removes one of the strongest arguments against the energy transition. The fact that fossil fuels are still widely used is therefore not primarily a cost issue, but rather the result of existing infrastructure, political decisions, and the need for reliable energy supply during the transition period.

The environmental analysis highlights why this transition matters. Countries with higher shares of renewable electricity generally emit less CO₂ per capita, demonstrating the direct climate benefits of clean energy. Overall, the findings suggest that the direction is right, but the speed is not. If current trends continue, reaching global climate targets will be extremely difficult. Accelerating the expansion of renewables, reducing reliance on fossil fuels, and addressing structural barriers are essential steps if the global energy system is to become truly sustainable in time.